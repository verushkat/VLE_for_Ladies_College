(function (global, factory) {
    typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('@angular/core'), require('rxjs'), require('rxjs/operators'), require('@angular/common'), require('@angular/material')) :
    typeof define === 'function' && define.amd ? define('ngx-float-button', ['exports', '@angular/core', 'rxjs', 'rxjs/operators', '@angular/common', '@angular/material'], factory) :
    (factory((global['ngx-float-button'] = {}),global.ng.core,global.rxjs,global.rxjs.operators,global.ng.common,global.ng.material));
}(this, (function (exports,i0,rxjs,operators,common,material) { 'use strict';

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
     */
    var NgxFloatButtonService = /** @class */ (function () {
        function NgxFloatButtonService() {
        }
        NgxFloatButtonService.decorators = [
            { type: i0.Injectable, args: [{
                        providedIn: 'root'
                    },] }
        ];
        /** @nocollapse */
        NgxFloatButtonService.ctorParameters = function () { return []; };
        /** @nocollapse */ NgxFloatButtonService.ngInjectableDef = i0.defineInjectable({ factory: function NgxFloatButtonService_Factory() { return new NgxFloatButtonService(); }, token: NgxFloatButtonService, providedIn: "root" });
        return NgxFloatButtonService;
    }());

    /*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */
    var __assign = function () {
        __assign = Object.assign || function __assign(t) {
            for (var s, i = 1, n = arguments.length; i < n; i++) {
                s = arguments[i];
                for (var p in s)
                    if (Object.prototype.hasOwnProperty.call(s, p))
                        t[p] = s[p];
            }
            return t;
        };
        return __assign.apply(this, arguments);
    };

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
     */
    var NgxFloatItemButtonComponent = /** @class */ (function () {
        function NgxFloatItemButtonComponent() {
            this.color = 'white';
            this.disabled = false;
            this.clicked = new i0.EventEmitter();
        }
        /**
         * @param {?} $event
         * @return {?}
         */
        NgxFloatItemButtonComponent.prototype.emitClickEvent = /**
         * @param {?} $event
         * @return {?}
         */
            function ($event) {
                if (this.disabled) {
                    return this.disabled;
                }
                this.clicked.emit($event);
            };
        NgxFloatItemButtonComponent.decorators = [
            { type: i0.Component, args: [{
                        selector: 'ngx-float-item-button',
                        template: "\n    <div #elementref class=\"item {{ disabled ? 'disabled' : ''}}\" (click)=\"emitClickEvent($event)\">\n        <div class=\"content-wrapper\" #contentref>\n          <div class=\"content\" [style.display]=\"content ? 'block' : 'none'\">{{content}}</div>\n        </div>\n        <a class=\"fab-item\" [style.backgroundColor]=\"color\">\n           <mat-icon> {{ icon }} </mat-icon>\n        </a>\n    </div>\n  ",
                        changeDetection: i0.ChangeDetectionStrategy.OnPush,
                        styles: ["\n      .item {\n        width: 250px;\n        height: 40px;\n        left: -203px;\n        transform: translate3d(0, 0, 0);\n        transition: transform, opacity ease-out 200ms;\n        transition-timing-function: cubic-bezier(0.165, 0.84, 0.44, 1);\n        transition-duration: 180ms;\n        position: absolute;\n        cursor: pointer;\n        top: 5px;\n        display: flex;\n        justify-content: flex-end;\n        align-items: center;\n      }\n\n      .item.disabled {\n        pointer-events: none;\n      }\n\n      .item.disabled .fab-item {\n        background-color: lightgray;\n      }\n\n      .content {\n        background: #333333;\n        margin-right: 50px;\n        line-height: 25px;\n        color: white;\n        padding: 2px 7px;\n        border-radius: 3px;\n        display: none;\n        font-size: 12px;\n        height: 25px;\n        margin-top: 4px;\n        box-shadow: 0 2px 5px 0 rgba(0, 0, 0, 0.26);\n      }\n\n      .fab-item {\n        right: 0;\n        background: white;\n        border-radius: 100%;\n        width: 40px;\n        height: 40px;\n        position: absolute;\n        color: #797979;\n        text-align: center;\n        cursor: pointer;\n        line-height: 50px;\n        box-shadow: 0 2px 5px 0 rgba(0, 0, 0, 0.26);\n      }\n    "]
                    }] }
        ];
        NgxFloatItemButtonComponent.propDecorators = {
            icon: [{ type: i0.Input }],
            content: [{ type: i0.Input }],
            color: [{ type: i0.Input }],
            disabled: [{ type: i0.Input }],
            clicked: [{ type: i0.Output }],
            elementref: [{ type: i0.ViewChild, args: ['elementref',] }],
            contentref: [{ type: i0.ViewChild, args: ['contentref',] }]
        };
        return NgxFloatItemButtonComponent;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
     */
    var NgxFloatButtonComponent = /** @class */ (function () {
        function NgxFloatButtonComponent(cd) {
            this.cd = cd;
            this.spaceBetweenButtons = 55;
            this.color = '#dd0031';
            this.disabled = false;
            this.events = new rxjs.Subject();
            this._destroy$ = new rxjs.Subject();
            this.state = new rxjs.BehaviorSubject({
                display: false,
                direction: 'top',
                event: 'start',
                spaceBetweenButtons: this.spaceBetweenButtons
            });
        }
        /**
         * @return {?}
         */
        NgxFloatButtonComponent.prototype.toggle = /**
         * @return {?}
         */
            function () {
                if (this.disabled) {
                    return this.disabled;
                }
                this.state.next(__assign({}, this.state.getValue(), { display: !this.state.getValue().display, event: !this.state.getValue().display ? 'open' : 'close' }));
            };
        // only top and bottom support content element
        // only top and bottom support content element
        /**
         * @return {?}
         */
        NgxFloatButtonComponent.prototype.checkDirectionType =
            // only top and bottom support content element
            /**
             * @return {?}
             */
            function () {
                if (this.buttons.toArray()) {
                    /** @type {?} */
                    var display_1 = 'block';
                    if (this.direction === 'right' || this.direction === 'left') {
                        display_1 = 'none';
                    }
                    this.buttons.toArray().forEach(function (element) {
                        element.contentref.nativeElement.style.display = display_1;
                    });
                }
            };
        // transition
        // transition
        /**
         * @param {?} eventType
         * @return {?}
         */
        NgxFloatButtonComponent.prototype.animateButtons =
            // transition
            /**
             * @param {?} eventType
             * @return {?}
             */
            function (eventType) {
                var _this = this;
                this.buttons.toArray().forEach(function (btn, i) {
                    i += 1;
                    /** @type {?} */
                    var style = btn.elementref.nativeElement.style;
                    if (eventType !== 'directionChanged' && _this.state.getValue().display) {
                        style['transform'] = 'scale(1)';
                        style['transition-duration'] = '0s';
                        if (btn.timeout) {
                            clearTimeout(btn.timeout);
                        }
                    }
                    setTimeout(function () {
                        style['transition-duration'] = _this.state.getValue().display ? 90 + 100 * i + "ms" : '';
                        style['transform'] = _this.state.getValue().display ? _this.getTranslate(i) : '';
                    }, 50);
                    if (eventType !== 'directionChanged' && !_this.state.getValue().display) {
                        btn.timeout = setTimeout(function () {
                            style['transform'] = 'scale(0)';
                        }, 90 + 100 * i);
                    }
                });
            };
        // get transition direction
        // get transition direction
        /**
         * @param {?} i
         * @return {?}
         */
        NgxFloatButtonComponent.prototype.getTranslate =
            // get transition direction
            /**
             * @param {?} i
             * @return {?}
             */
            function (i) {
                /** @type {?} */
                var animation;
                switch (this.direction) {
                    case 'right':
                        animation = "translate3d(" + this.state.getValue().spaceBetweenButtons * i + "px,0,0)";
                        break;
                    case 'bottom':
                        animation = "translate3d(0," + this.state.getValue().spaceBetweenButtons * i + "px,0)";
                        break;
                    case 'left':
                        animation = "translate3d(-" + this.state.getValue().spaceBetweenButtons * i + "px,0,0)";
                        break;
                    default:
                        animation = "translate3d(0,-" + this.state.getValue().spaceBetweenButtons * i + "px,0)";
                        break;
                }
                return animation;
            };
        /**
         * @return {?}
         */
        NgxFloatButtonComponent.prototype.ngAfterContentInit = /**
         * @return {?}
         */
            function () {
                var _this = this;
                if (this.direction) {
                    // first time to check
                    this.checkDirectionType();
                }
                this.buttons.toArray().map(function (v) {
                    v.clicked.pipe(operators.takeUntil(_this._destroy$)).subscribe(function () {
                        _this.state.next(__assign({}, _this.state.getValue(), { display: false, event: 'close' }));
                    });
                });
                this.state.pipe(operators.takeUntil(this._destroy$)).subscribe(function (v) {
                    _this.animateButtons(v.event);
                    _this.events.next({
                        display: v.display,
                        event: v.event,
                        direction: v.direction
                    });
                });
            };
        // if @Input values changes, we need check the direction type
        // if @Input values changes, we need check the direction type
        /**
         * @param {?} changes
         * @return {?}
         */
        NgxFloatButtonComponent.prototype.ngOnChanges =
            // if @Input values changes, we need check the direction type
            /**
             * @param {?} changes
             * @return {?}
             */
            function (changes) {
                var _this = this;
                if (changes.direction && !changes.direction.firstChange) {
                    this.state.next(__assign({}, this.state.getValue(), { event: 'directionChanged', direction: changes.direction.currentValue }));
                    // if changes happens
                    this.checkDirectionType();
                }
                if (changes.open && changes.open.currentValue) {
                    this.open.pipe(operators.takeUntil(this._destroy$)).subscribe(function (v) {
                        if (v !== _this.state.getValue().display) {
                            _this.state.next(__assign({}, _this.state.getValue(), { event: v ? 'open' : 'close', display: v }));
                            // make angular happy
                            _this.cd.markForCheck();
                        }
                    });
                }
                if (changes.spaceBetweenButtons && changes.spaceBetweenButtons.currentValue) {
                    this.state.next(__assign({}, this.state.getValue(), { event: 'spaceBetweenButtonsChanged', spaceBetweenButtons: changes.spaceBetweenButtons.currentValue }));
                }
            };
        /**
         * @return {?}
         */
        NgxFloatButtonComponent.prototype.ngOnDestroy = /**
         * @return {?}
         */
            function () {
                this._destroy$.next();
            };
        NgxFloatButtonComponent.decorators = [
            { type: i0.Component, args: [{
                        changeDetection: i0.ChangeDetectionStrategy.OnPush,
                        selector: 'ngx-float-button',
                        template: "\n    <nav class=\"fab-menu\" [class.active]=\"(state | async).display\">\n        <a class=\"fab-toggle\" (click)=\"toggle()\" [style.backgroundColor]=\"color\">\n          <mat-icon> {{icon}} </mat-icon>\n        </a>\n        <ng-content></ng-content>\n    </nav>\n  ",
                        styles: ["\n      :host {\n        position: absolute;\n      }\n\n      .fab-menu {\n        box-sizing: border-box;\n        font-size: 20px;\n        width: 55px;\n        height: 55px;\n        text-align: left;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        cursor: pointer;\n        z-index: 9;\n      }\n\n      .fab-toggle {\n        border-radius: 100%;\n        width: 40px;\n        height: 40px;\n        color: white;\n        text-align: center;\n        line-height: 50px;\n        transform: translate3d(0, 0, 0);\n        transition: all ease-out 200ms;\n        z-index: 2;\n        transition-timing-function: cubic-bezier(0.175, 0.885, 0.32, 1.275);\n        transition-duration: 400ms;\n        transform: scale(1.1, 1.1) translate3d(0, 0, 0);\n        cursor: pointer;\n        box-shadow: 0 2px 5px 0 rgba(0, 0, 0, 0.26);\n      }\n\n      .fab-menu .fab-toggle:hover {\n        transform: scale(1.2, 1.2) translate3d(0, 0, 0);\n      }\n\n      .fab-menu /deep/ .item {\n        opacity: 0;\n      }\n\n      .fab-menu.active /deep/ .item {\n        opacity: 1;\n      }\n\n      .fab-menu.active /deep/ .content-wrapper {\n        display: flex;\n        justify-content: center;\n        align-items: center;\n      }\n\n      .fab-menu.active /deep/ .content {\n        display: block;\n      }\n\n      .fab-menu.active .fab-toggle {\n        transition-timing-function: linear;\n        transition-duration: 200ms;\n        transform: scale(0.8, 0.8) translate3d(0, 0, 0);\n      }\n    "]
                    }] }
        ];
        /** @nocollapse */
        NgxFloatButtonComponent.ctorParameters = function () {
            return [
                { type: i0.ChangeDetectorRef }
            ];
        };
        NgxFloatButtonComponent.propDecorators = {
            icon: [{ type: i0.Input }],
            direction: [{ type: i0.Input }],
            spaceBetweenButtons: [{ type: i0.Input }],
            open: [{ type: i0.Input }],
            color: [{ type: i0.Input }],
            disabled: [{ type: i0.Input }],
            events: [{ type: i0.Output }],
            buttons: [{ type: i0.ContentChildren, args: [NgxFloatItemButtonComponent,] }]
        };
        return NgxFloatButtonComponent;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
     */
    var NgxFloatButtonModule = /** @class */ (function () {
        function NgxFloatButtonModule() {
        }
        NgxFloatButtonModule.decorators = [
            { type: i0.NgModule, args: [{
                        imports: [common.CommonModule, material.MatIconModule],
                        declarations: [NgxFloatButtonComponent, NgxFloatItemButtonComponent],
                        exports: [NgxFloatButtonComponent, NgxFloatItemButtonComponent]
                    },] }
        ];
        return NgxFloatButtonModule;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
     */

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
     */

    exports.NgxFloatButtonService = NgxFloatButtonService;
    exports.NgxFloatButtonComponent = NgxFloatButtonComponent;
    exports.NgxFloatButtonModule = NgxFloatButtonModule;
    exports.ɵa = NgxFloatItemButtonComponent;

    Object.defineProperty(exports, '__esModule', { value: true });

})));

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmd4LWZsb2F0LWJ1dHRvbi51bWQuanMubWFwIiwic291cmNlcyI6WyJuZzovL25neC1mbG9hdC1idXR0b24vbGliL25neC1mbG9hdC1idXR0b24uc2VydmljZS50cyIsIm5vZGVfbW9kdWxlcy90c2xpYi90c2xpYi5lczYuanMiLCJuZzovL25neC1mbG9hdC1idXR0b24vbGliL25neC1mbG9hdC1pdGVtLWJ1dHRvbi5jb21wb25lbnQudHMiLCJuZzovL25neC1mbG9hdC1idXR0b24vbGliL25neC1mbG9hdC1idXR0b24uY29tcG9uZW50LnRzIiwibmc6Ly9uZ3gtZmxvYXQtYnV0dG9uL2xpYi9uZ3gtZmxvYXQtYnV0dG9uLm1vZHVsZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5cbkBJbmplY3RhYmxlKHtcbiAgcHJvdmlkZWRJbjogJ3Jvb3QnXG59KVxuZXhwb3J0IGNsYXNzIE5neEZsb2F0QnV0dG9uU2VydmljZSB7XG5cbiAgY29uc3RydWN0b3IoKSB7IH1cbn1cbiIsIi8qISAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxyXG5Db3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cclxuTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTsgeW91IG1heSBub3QgdXNlXHJcbnRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlXHJcbkxpY2Vuc2UgYXQgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcblxyXG5USElTIENPREUgSVMgUFJPVklERUQgT04gQU4gKkFTIElTKiBCQVNJUywgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZXHJcbktJTkQsIEVJVEhFUiBFWFBSRVNTIE9SIElNUExJRUQsIElOQ0xVRElORyBXSVRIT1VUIExJTUlUQVRJT04gQU5ZIElNUExJRURcclxuV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIFRJVExFLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSxcclxuTUVSQ0hBTlRBQkxJVFkgT1IgTk9OLUlORlJJTkdFTUVOVC5cclxuXHJcblNlZSB0aGUgQXBhY2hlIFZlcnNpb24gMi4wIExpY2Vuc2UgZm9yIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9uc1xyXG5hbmQgbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqICovXHJcbi8qIGdsb2JhbCBSZWZsZWN0LCBQcm9taXNlICovXHJcblxyXG52YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uKGQsIGIpIHtcclxuICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcclxuICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XHJcbiAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07XHJcbiAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcclxufTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2V4dGVuZHMoZCwgYikge1xyXG4gICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcclxuICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxyXG4gICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xyXG59XHJcblxyXG5leHBvcnQgdmFyIF9fYXNzaWduID0gZnVuY3Rpb24oKSB7XHJcbiAgICBfX2Fzc2lnbiA9IE9iamVjdC5hc3NpZ24gfHwgZnVuY3Rpb24gX19hc3NpZ24odCkge1xyXG4gICAgICAgIGZvciAodmFyIHMsIGkgPSAxLCBuID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IG47IGkrKykge1xyXG4gICAgICAgICAgICBzID0gYXJndW1lbnRzW2ldO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBwIGluIHMpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocywgcCkpIHRbcF0gPSBzW3BdO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdDtcclxuICAgIH1cclxuICAgIHJldHVybiBfX2Fzc2lnbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19yZXN0KHMsIGUpIHtcclxuICAgIHZhciB0ID0ge307XHJcbiAgICBmb3IgKHZhciBwIGluIHMpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocywgcCkgJiYgZS5pbmRleE9mKHApIDwgMClcclxuICAgICAgICB0W3BdID0gc1twXTtcclxuICAgIGlmIChzICE9IG51bGwgJiYgdHlwZW9mIE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMgPT09IFwiZnVuY3Rpb25cIilcclxuICAgICAgICBmb3IgKHZhciBpID0gMCwgcCA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMocyk7IGkgPCBwLmxlbmd0aDsgaSsrKSBpZiAoZS5pbmRleE9mKHBbaV0pIDwgMClcclxuICAgICAgICAgICAgdFtwW2ldXSA9IHNbcFtpXV07XHJcbiAgICByZXR1cm4gdDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpIHtcclxuICAgIHZhciBjID0gYXJndW1lbnRzLmxlbmd0aCwgciA9IGMgPCAzID8gdGFyZ2V0IDogZGVzYyA9PT0gbnVsbCA/IGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHRhcmdldCwga2V5KSA6IGRlc2MsIGQ7XHJcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QuZGVjb3JhdGUgPT09IFwiZnVuY3Rpb25cIikgciA9IFJlZmxlY3QuZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpO1xyXG4gICAgZWxzZSBmb3IgKHZhciBpID0gZGVjb3JhdG9ycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgaWYgKGQgPSBkZWNvcmF0b3JzW2ldKSByID0gKGMgPCAzID8gZChyKSA6IGMgPiAzID8gZCh0YXJnZXQsIGtleSwgcikgOiBkKHRhcmdldCwga2V5KSkgfHwgcjtcclxuICAgIHJldHVybiBjID4gMyAmJiByICYmIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgciksIHI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3BhcmFtKHBhcmFtSW5kZXgsIGRlY29yYXRvcikge1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YXJnZXQsIGtleSkgeyBkZWNvcmF0b3IodGFyZ2V0LCBrZXksIHBhcmFtSW5kZXgpOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX21ldGFkYXRhKG1ldGFkYXRhS2V5LCBtZXRhZGF0YVZhbHVlKSB7XHJcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QubWV0YWRhdGEgPT09IFwiZnVuY3Rpb25cIikgcmV0dXJuIFJlZmxlY3QubWV0YWRhdGEobWV0YWRhdGFLZXksIG1ldGFkYXRhVmFsdWUpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hd2FpdGVyKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xyXG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZShyZXN1bHQudmFsdWUpOyB9KS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XHJcbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2dlbmVyYXRvcih0aGlzQXJnLCBib2R5KSB7XHJcbiAgICB2YXIgXyA9IHsgbGFiZWw6IDAsIHNlbnQ6IGZ1bmN0aW9uKCkgeyBpZiAodFswXSAmIDEpIHRocm93IHRbMV07IHJldHVybiB0WzFdOyB9LCB0cnlzOiBbXSwgb3BzOiBbXSB9LCBmLCB5LCB0LCBnO1xyXG4gICAgcmV0dXJuIGcgPSB7IG5leHQ6IHZlcmIoMCksIFwidGhyb3dcIjogdmVyYigxKSwgXCJyZXR1cm5cIjogdmVyYigyKSB9LCB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgKGdbU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpczsgfSksIGc7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgcmV0dXJuIGZ1bmN0aW9uICh2KSB7IHJldHVybiBzdGVwKFtuLCB2XSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHN0ZXAob3ApIHtcclxuICAgICAgICBpZiAoZikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkdlbmVyYXRvciBpcyBhbHJlYWR5IGV4ZWN1dGluZy5cIik7XHJcbiAgICAgICAgd2hpbGUgKF8pIHRyeSB7XHJcbiAgICAgICAgICAgIGlmIChmID0gMSwgeSAmJiAodCA9IG9wWzBdICYgMiA/IHlbXCJyZXR1cm5cIl0gOiBvcFswXSA/IHlbXCJ0aHJvd1wiXSB8fCAoKHQgPSB5W1wicmV0dXJuXCJdKSAmJiB0LmNhbGwoeSksIDApIDogeS5uZXh0KSAmJiAhKHQgPSB0LmNhbGwoeSwgb3BbMV0pKS5kb25lKSByZXR1cm4gdDtcclxuICAgICAgICAgICAgaWYgKHkgPSAwLCB0KSBvcCA9IFtvcFswXSAmIDIsIHQudmFsdWVdO1xyXG4gICAgICAgICAgICBzd2l0Y2ggKG9wWzBdKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDA6IGNhc2UgMTogdCA9IG9wOyBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgNDogXy5sYWJlbCsrOyByZXR1cm4geyB2YWx1ZTogb3BbMV0sIGRvbmU6IGZhbHNlIH07XHJcbiAgICAgICAgICAgICAgICBjYXNlIDU6IF8ubGFiZWwrKzsgeSA9IG9wWzFdOyBvcCA9IFswXTsgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDc6IG9wID0gXy5vcHMucG9wKCk7IF8udHJ5cy5wb3AoKTsgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghKHQgPSBfLnRyeXMsIHQgPSB0Lmxlbmd0aCA+IDAgJiYgdFt0Lmxlbmd0aCAtIDFdKSAmJiAob3BbMF0gPT09IDYgfHwgb3BbMF0gPT09IDIpKSB7IF8gPSAwOyBjb250aW51ZTsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gMyAmJiAoIXQgfHwgKG9wWzFdID4gdFswXSAmJiBvcFsxXSA8IHRbM10pKSkgeyBfLmxhYmVsID0gb3BbMV07IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9wWzBdID09PSA2ICYmIF8ubGFiZWwgPCB0WzFdKSB7IF8ubGFiZWwgPSB0WzFdOyB0ID0gb3A7IGJyZWFrOyB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHQgJiYgXy5sYWJlbCA8IHRbMl0pIHsgXy5sYWJlbCA9IHRbMl07IF8ub3BzLnB1c2gob3ApOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0WzJdKSBfLm9wcy5wb3AoKTtcclxuICAgICAgICAgICAgICAgICAgICBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG9wID0gYm9keS5jYWxsKHRoaXNBcmcsIF8pO1xyXG4gICAgICAgIH0gY2F0Y2ggKGUpIHsgb3AgPSBbNiwgZV07IHkgPSAwOyB9IGZpbmFsbHkgeyBmID0gdCA9IDA7IH1cclxuICAgICAgICBpZiAob3BbMF0gJiA1KSB0aHJvdyBvcFsxXTsgcmV0dXJuIHsgdmFsdWU6IG9wWzBdID8gb3BbMV0gOiB2b2lkIDAsIGRvbmU6IHRydWUgfTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fZXhwb3J0U3RhcihtLCBleHBvcnRzKSB7XHJcbiAgICBmb3IgKHZhciBwIGluIG0pIGlmICghZXhwb3J0cy5oYXNPd25Qcm9wZXJ0eShwKSkgZXhwb3J0c1twXSA9IG1bcF07XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3ZhbHVlcyhvKSB7XHJcbiAgICB2YXIgbSA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvW1N5bWJvbC5pdGVyYXRvcl0sIGkgPSAwO1xyXG4gICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIG5leHQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDtcclxuICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9O1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX3JlYWQobywgbikge1xyXG4gICAgdmFyIG0gPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb1tTeW1ib2wuaXRlcmF0b3JdO1xyXG4gICAgaWYgKCFtKSByZXR1cm4gbztcclxuICAgIHZhciBpID0gbS5jYWxsKG8pLCByLCBhciA9IFtdLCBlO1xyXG4gICAgdHJ5IHtcclxuICAgICAgICB3aGlsZSAoKG4gPT09IHZvaWQgMCB8fCBuLS0gPiAwKSAmJiAhKHIgPSBpLm5leHQoKSkuZG9uZSkgYXIucHVzaChyLnZhbHVlKTtcclxuICAgIH1cclxuICAgIGNhdGNoIChlcnJvcikgeyBlID0geyBlcnJvcjogZXJyb3IgfTsgfVxyXG4gICAgZmluYWxseSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKHIgJiYgIXIuZG9uZSAmJiAobSA9IGlbXCJyZXR1cm5cIl0pKSBtLmNhbGwoaSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZpbmFsbHkgeyBpZiAoZSkgdGhyb3cgZS5lcnJvcjsgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGFyO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19zcHJlYWQoKSB7XHJcbiAgICBmb3IgKHZhciBhciA9IFtdLCBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKylcclxuICAgICAgICBhciA9IGFyLmNvbmNhdChfX3JlYWQoYXJndW1lbnRzW2ldKSk7XHJcbiAgICByZXR1cm4gYXI7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2F3YWl0KHYpIHtcclxuICAgIHJldHVybiB0aGlzIGluc3RhbmNlb2YgX19hd2FpdCA/ICh0aGlzLnYgPSB2LCB0aGlzKSA6IG5ldyBfX2F3YWl0KHYpO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY0dlbmVyYXRvcih0aGlzQXJnLCBfYXJndW1lbnRzLCBnZW5lcmF0b3IpIHtcclxuICAgIGlmICghU3ltYm9sLmFzeW5jSXRlcmF0b3IpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJTeW1ib2wuYXN5bmNJdGVyYXRvciBpcyBub3QgZGVmaW5lZC5cIik7XHJcbiAgICB2YXIgZyA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSwgaSwgcSA9IFtdO1xyXG4gICAgcmV0dXJuIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiKSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuYXN5bmNJdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9LCBpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IGlmIChnW25dKSBpW25dID0gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChhLCBiKSB7IHEucHVzaChbbiwgdiwgYSwgYl0pID4gMSB8fCByZXN1bWUobiwgdik7IH0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiByZXN1bWUobiwgdikgeyB0cnkgeyBzdGVwKGdbbl0odikpOyB9IGNhdGNoIChlKSB7IHNldHRsZShxWzBdWzNdLCBlKTsgfSB9XHJcbiAgICBmdW5jdGlvbiBzdGVwKHIpIHsgci52YWx1ZSBpbnN0YW5jZW9mIF9fYXdhaXQgPyBQcm9taXNlLnJlc29sdmUoci52YWx1ZS52KS50aGVuKGZ1bGZpbGwsIHJlamVjdCkgOiBzZXR0bGUocVswXVsyXSwgcik7IH1cclxuICAgIGZ1bmN0aW9uIGZ1bGZpbGwodmFsdWUpIHsgcmVzdW1lKFwibmV4dFwiLCB2YWx1ZSk7IH1cclxuICAgIGZ1bmN0aW9uIHJlamVjdCh2YWx1ZSkgeyByZXN1bWUoXCJ0aHJvd1wiLCB2YWx1ZSk7IH1cclxuICAgIGZ1bmN0aW9uIHNldHRsZShmLCB2KSB7IGlmIChmKHYpLCBxLnNoaWZ0KCksIHEubGVuZ3RoKSByZXN1bWUocVswXVswXSwgcVswXVsxXSk7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNEZWxlZ2F0b3Iobykge1xyXG4gICAgdmFyIGksIHA7XHJcbiAgICByZXR1cm4gaSA9IHt9LCB2ZXJiKFwibmV4dFwiKSwgdmVyYihcInRocm93XCIsIGZ1bmN0aW9uIChlKSB7IHRocm93IGU7IH0pLCB2ZXJiKFwicmV0dXJuXCIpLCBpW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9LCBpO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuLCBmKSB7IGlbbl0gPSBvW25dID8gZnVuY3Rpb24gKHYpIHsgcmV0dXJuIChwID0gIXApID8geyB2YWx1ZTogX19hd2FpdChvW25dKHYpKSwgZG9uZTogbiA9PT0gXCJyZXR1cm5cIiB9IDogZiA/IGYodikgOiB2OyB9IDogZjsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hc3luY1ZhbHVlcyhvKSB7XHJcbiAgICBpZiAoIVN5bWJvbC5hc3luY0l0ZXJhdG9yKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3ltYm9sLmFzeW5jSXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xyXG4gICAgdmFyIG0gPSBvW1N5bWJvbC5hc3luY0l0ZXJhdG9yXSwgaTtcclxuICAgIHJldHVybiBtID8gbS5jYWxsKG8pIDogKG8gPSB0eXBlb2YgX192YWx1ZXMgPT09IFwiZnVuY3Rpb25cIiA/IF9fdmFsdWVzKG8pIDogb1tTeW1ib2wuaXRlcmF0b3JdKCksIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiKSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuYXN5bmNJdGVyYXRvcl0gPSBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzOyB9LCBpKTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyBpW25dID0gb1tuXSAmJiBmdW5jdGlvbiAodikgeyByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgeyB2ID0gb1tuXSh2KSwgc2V0dGxlKHJlc29sdmUsIHJlamVjdCwgdi5kb25lLCB2LnZhbHVlKTsgfSk7IH07IH1cclxuICAgIGZ1bmN0aW9uIHNldHRsZShyZXNvbHZlLCByZWplY3QsIGQsIHYpIHsgUHJvbWlzZS5yZXNvbHZlKHYpLnRoZW4oZnVuY3Rpb24odikgeyByZXNvbHZlKHsgdmFsdWU6IHYsIGRvbmU6IGQgfSk7IH0sIHJlamVjdCk7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fbWFrZVRlbXBsYXRlT2JqZWN0KGNvb2tlZCwgcmF3KSB7XHJcbiAgICBpZiAoT2JqZWN0LmRlZmluZVByb3BlcnR5KSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShjb29rZWQsIFwicmF3XCIsIHsgdmFsdWU6IHJhdyB9KTsgfSBlbHNlIHsgY29va2VkLnJhdyA9IHJhdzsgfVxyXG4gICAgcmV0dXJuIGNvb2tlZDtcclxufTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2ltcG9ydFN0YXIobW9kKSB7XHJcbiAgICBpZiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSByZXR1cm4gbW9kO1xyXG4gICAgdmFyIHJlc3VsdCA9IHt9O1xyXG4gICAgaWYgKG1vZCAhPSBudWxsKSBmb3IgKHZhciBrIGluIG1vZCkgaWYgKE9iamVjdC5oYXNPd25Qcm9wZXJ0eS5jYWxsKG1vZCwgaykpIHJlc3VsdFtrXSA9IG1vZFtrXTtcclxuICAgIHJlc3VsdC5kZWZhdWx0ID0gbW9kO1xyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9faW1wb3J0RGVmYXVsdChtb2QpIHtcclxuICAgIHJldHVybiAobW9kICYmIG1vZC5fX2VzTW9kdWxlKSA/IG1vZCA6IHsgZGVmYXVsdDogbW9kIH07XHJcbn1cclxuIiwiaW1wb3J0IHsgQ29tcG9uZW50LCBJbnB1dCwgT3V0cHV0LCBFdmVudEVtaXR0ZXIsIFZpZXdDaGlsZCwgQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuXHJcbkBDb21wb25lbnQoe1xyXG4gIHNlbGVjdG9yOiAnbmd4LWZsb2F0LWl0ZW0tYnV0dG9uJyxcclxuICBzdHlsZXM6IFtcclxuICAgIGBcclxuICAgICAgLml0ZW0ge1xyXG4gICAgICAgIHdpZHRoOiAyNTBweDtcclxuICAgICAgICBoZWlnaHQ6IDQwcHg7XHJcbiAgICAgICAgbGVmdDogLTIwM3B4O1xyXG4gICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlM2QoMCwgMCwgMCk7XHJcbiAgICAgICAgdHJhbnNpdGlvbjogdHJhbnNmb3JtLCBvcGFjaXR5IGVhc2Utb3V0IDIwMG1zO1xyXG4gICAgICAgIHRyYW5zaXRpb24tdGltaW5nLWZ1bmN0aW9uOiBjdWJpYy1iZXppZXIoMC4xNjUsIDAuODQsIDAuNDQsIDEpO1xyXG4gICAgICAgIHRyYW5zaXRpb24tZHVyYXRpb246IDE4MG1zO1xyXG4gICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcclxuICAgICAgICBjdXJzb3I6IHBvaW50ZXI7XHJcbiAgICAgICAgdG9wOiA1cHg7XHJcbiAgICAgICAgZGlzcGxheTogZmxleDtcclxuICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGZsZXgtZW5kO1xyXG4gICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC5pdGVtLmRpc2FibGVkIHtcclxuICAgICAgICBwb2ludGVyLWV2ZW50czogbm9uZTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLml0ZW0uZGlzYWJsZWQgLmZhYi1pdGVtIHtcclxuICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiBsaWdodGdyYXk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC5jb250ZW50IHtcclxuICAgICAgICBiYWNrZ3JvdW5kOiAjMzMzMzMzO1xyXG4gICAgICAgIG1hcmdpbi1yaWdodDogNTBweDtcclxuICAgICAgICBsaW5lLWhlaWdodDogMjVweDtcclxuICAgICAgICBjb2xvcjogd2hpdGU7XHJcbiAgICAgICAgcGFkZGluZzogMnB4IDdweDtcclxuICAgICAgICBib3JkZXItcmFkaXVzOiAzcHg7XHJcbiAgICAgICAgZGlzcGxheTogbm9uZTtcclxuICAgICAgICBmb250LXNpemU6IDEycHg7XHJcbiAgICAgICAgaGVpZ2h0OiAyNXB4O1xyXG4gICAgICAgIG1hcmdpbi10b3A6IDRweDtcclxuICAgICAgICBib3gtc2hhZG93OiAwIDJweCA1cHggMCByZ2JhKDAsIDAsIDAsIDAuMjYpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAuZmFiLWl0ZW0ge1xyXG4gICAgICAgIHJpZ2h0OiAwO1xyXG4gICAgICAgIGJhY2tncm91bmQ6IHdoaXRlO1xyXG4gICAgICAgIGJvcmRlci1yYWRpdXM6IDEwMCU7XHJcbiAgICAgICAgd2lkdGg6IDQwcHg7XHJcbiAgICAgICAgaGVpZ2h0OiA0MHB4O1xyXG4gICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcclxuICAgICAgICBjb2xvcjogIzc5Nzk3OTtcclxuICAgICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XHJcbiAgICAgICAgY3Vyc29yOiBwb2ludGVyO1xyXG4gICAgICAgIGxpbmUtaGVpZ2h0OiA1MHB4O1xyXG4gICAgICAgIGJveC1zaGFkb3c6IDAgMnB4IDVweCAwIHJnYmEoMCwgMCwgMCwgMC4yNik7XHJcbiAgICAgIH1cclxuICAgIGBcclxuICBdLFxyXG4gIHRlbXBsYXRlOiBgXHJcbiAgICA8ZGl2ICNlbGVtZW50cmVmIGNsYXNzPVwiaXRlbSB7eyBkaXNhYmxlZCA/ICdkaXNhYmxlZCcgOiAnJ319XCIgKGNsaWNrKT1cImVtaXRDbGlja0V2ZW50KCRldmVudClcIj5cclxuICAgICAgICA8ZGl2IGNsYXNzPVwiY29udGVudC13cmFwcGVyXCIgI2NvbnRlbnRyZWY+XHJcbiAgICAgICAgICA8ZGl2IGNsYXNzPVwiY29udGVudFwiIFtzdHlsZS5kaXNwbGF5XT1cImNvbnRlbnQgPyAnYmxvY2snIDogJ25vbmUnXCI+e3tjb250ZW50fX08L2Rpdj5cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgICA8YSBjbGFzcz1cImZhYi1pdGVtXCIgW3N0eWxlLmJhY2tncm91bmRDb2xvcl09XCJjb2xvclwiPlxyXG4gICAgICAgICAgIDxtYXQtaWNvbj4ge3sgaWNvbiB9fSA8L21hdC1pY29uPlxyXG4gICAgICAgIDwvYT5cclxuICAgIDwvZGl2PlxyXG4gIGAsXHJcbiAgY2hhbmdlRGV0ZWN0aW9uOiBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneS5PblB1c2hcclxufSlcclxuZXhwb3J0IGNsYXNzIE5neEZsb2F0SXRlbUJ1dHRvbkNvbXBvbmVudCB7XHJcbiAgQElucHV0KClcclxuICBpY29uOiBzdHJpbmc7XHJcbiAgQElucHV0KClcclxuICBjb250ZW50OiBzdHJpbmc7XHJcbiAgQElucHV0KClcclxuICBjb2xvciA9ICd3aGl0ZSc7XHJcbiAgQElucHV0KClcclxuICBkaXNhYmxlZCA9IGZhbHNlO1xyXG5cclxuICBAT3V0cHV0KClcclxuICBjbGlja2VkOiBFdmVudEVtaXR0ZXI8YW55PiA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcclxuXHJcbiAgQFZpZXdDaGlsZCgnZWxlbWVudHJlZicpXHJcbiAgZWxlbWVudHJlZjtcclxuXHJcbiAgQFZpZXdDaGlsZCgnY29udGVudHJlZicpXHJcbiAgY29udGVudHJlZjtcclxuXHJcbiAgZW1pdENsaWNrRXZlbnQoJGV2ZW50OiBFdmVudCkge1xyXG4gICAgaWYgKHRoaXMuZGlzYWJsZWQpIHtcclxuICAgICAgcmV0dXJuIHRoaXMuZGlzYWJsZWQ7XHJcbiAgICB9XHJcbiAgICB0aGlzLmNsaWNrZWQuZW1pdCgkZXZlbnQpO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQge1xuICBDb21wb25lbnQsXG4gIElucHV0LFxuICBDb250ZW50Q2hpbGRyZW4sXG4gIENoYW5nZURldGVjdGlvblN0cmF0ZWd5LFxuICBDaGFuZ2VEZXRlY3RvclJlZixcbiAgQWZ0ZXJDb250ZW50SW5pdCxcbiAgT25EZXN0cm95LFxuICBPdXRwdXQsXG4gIE9uQ2hhbmdlc1xufSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IFN1YmplY3QsIEJlaGF2aW9yU3ViamVjdCB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgdGFrZVVudGlsIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuXG5pbXBvcnQgeyBOZ3hGbG9hdEl0ZW1CdXR0b25Db21wb25lbnQgfSBmcm9tICcuL25neC1mbG9hdC1pdGVtLWJ1dHRvbi5jb21wb25lbnQnO1xuXG5AQ29tcG9uZW50KHtcbiAgY2hhbmdlRGV0ZWN0aW9uOiBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneS5PblB1c2gsXG4gIHNlbGVjdG9yOiAnbmd4LWZsb2F0LWJ1dHRvbicsXG4gIHN0eWxlczogW1xuICAgIGBcbiAgICAgIDpob3N0IHtcbiAgICAgICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgICAgfVxuXG4gICAgICAuZmFiLW1lbnUge1xuICAgICAgICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xuICAgICAgICBmb250LXNpemU6IDIwcHg7XG4gICAgICAgIHdpZHRoOiA1NXB4O1xuICAgICAgICBoZWlnaHQ6IDU1cHg7XG4gICAgICAgIHRleHQtYWxpZ246IGxlZnQ7XG4gICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xuICAgICAgICBjdXJzb3I6IHBvaW50ZXI7XG4gICAgICAgIHotaW5kZXg6IDk7XG4gICAgICB9XG5cbiAgICAgIC5mYWItdG9nZ2xlIHtcbiAgICAgICAgYm9yZGVyLXJhZGl1czogMTAwJTtcbiAgICAgICAgd2lkdGg6IDQwcHg7XG4gICAgICAgIGhlaWdodDogNDBweDtcbiAgICAgICAgY29sb3I6IHdoaXRlO1xuICAgICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XG4gICAgICAgIGxpbmUtaGVpZ2h0OiA1MHB4O1xuICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZTNkKDAsIDAsIDApO1xuICAgICAgICB0cmFuc2l0aW9uOiBhbGwgZWFzZS1vdXQgMjAwbXM7XG4gICAgICAgIHotaW5kZXg6IDI7XG4gICAgICAgIHRyYW5zaXRpb24tdGltaW5nLWZ1bmN0aW9uOiBjdWJpYy1iZXppZXIoMC4xNzUsIDAuODg1LCAwLjMyLCAxLjI3NSk7XG4gICAgICAgIHRyYW5zaXRpb24tZHVyYXRpb246IDQwMG1zO1xuICAgICAgICB0cmFuc2Zvcm06IHNjYWxlKDEuMSwgMS4xKSB0cmFuc2xhdGUzZCgwLCAwLCAwKTtcbiAgICAgICAgY3Vyc29yOiBwb2ludGVyO1xuICAgICAgICBib3gtc2hhZG93OiAwIDJweCA1cHggMCByZ2JhKDAsIDAsIDAsIDAuMjYpO1xuICAgICAgfVxuXG4gICAgICAuZmFiLW1lbnUgLmZhYi10b2dnbGU6aG92ZXIge1xuICAgICAgICB0cmFuc2Zvcm06IHNjYWxlKDEuMiwgMS4yKSB0cmFuc2xhdGUzZCgwLCAwLCAwKTtcbiAgICAgIH1cblxuICAgICAgLmZhYi1tZW51IC9kZWVwLyAuaXRlbSB7XG4gICAgICAgIG9wYWNpdHk6IDA7XG4gICAgICB9XG5cbiAgICAgIC5mYWItbWVudS5hY3RpdmUgL2RlZXAvIC5pdGVtIHtcbiAgICAgICAgb3BhY2l0eTogMTtcbiAgICAgIH1cblxuICAgICAgLmZhYi1tZW51LmFjdGl2ZSAvZGVlcC8gLmNvbnRlbnQtd3JhcHBlciB7XG4gICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xuICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgICAgfVxuXG4gICAgICAuZmFiLW1lbnUuYWN0aXZlIC9kZWVwLyAuY29udGVudCB7XG4gICAgICAgIGRpc3BsYXk6IGJsb2NrO1xuICAgICAgfVxuXG4gICAgICAuZmFiLW1lbnUuYWN0aXZlIC5mYWItdG9nZ2xlIHtcbiAgICAgICAgdHJhbnNpdGlvbi10aW1pbmctZnVuY3Rpb246IGxpbmVhcjtcbiAgICAgICAgdHJhbnNpdGlvbi1kdXJhdGlvbjogMjAwbXM7XG4gICAgICAgIHRyYW5zZm9ybTogc2NhbGUoMC44LCAwLjgpIHRyYW5zbGF0ZTNkKDAsIDAsIDApO1xuICAgICAgfVxuICAgIGBcbiAgXSxcbiAgdGVtcGxhdGU6IGBcbiAgICA8bmF2IGNsYXNzPVwiZmFiLW1lbnVcIiBbY2xhc3MuYWN0aXZlXT1cIihzdGF0ZSB8IGFzeW5jKS5kaXNwbGF5XCI+XG4gICAgICAgIDxhIGNsYXNzPVwiZmFiLXRvZ2dsZVwiIChjbGljayk9XCJ0b2dnbGUoKVwiIFtzdHlsZS5iYWNrZ3JvdW5kQ29sb3JdPVwiY29sb3JcIj5cbiAgICAgICAgICA8bWF0LWljb24+IHt7aWNvbn19IDwvbWF0LWljb24+XG4gICAgICAgIDwvYT5cbiAgICAgICAgPG5nLWNvbnRlbnQ+PC9uZy1jb250ZW50PlxuICAgIDwvbmF2PlxuICBgXG59KVxuZXhwb3J0IGNsYXNzIE5neEZsb2F0QnV0dG9uQ29tcG9uZW50IGltcGxlbWVudHMgQWZ0ZXJDb250ZW50SW5pdCwgT25EZXN0cm95LCBPbkNoYW5nZXMge1xuICBwdWJsaWMgc3RhdGU6IEJlaGF2aW9yU3ViamVjdDxhbnk+O1xuXG4gIEBJbnB1dCgpXG4gIGljb246IHN0cmluZztcbiAgQElucHV0KClcbiAgZGlyZWN0aW9uOiBzdHJpbmc7XG4gIEBJbnB1dCgpXG4gIHNwYWNlQmV0d2VlbkJ1dHRvbnMgPSA1NTtcbiAgQElucHV0KClcbiAgb3BlbjogU3ViamVjdDxib29sZWFuPjtcbiAgQElucHV0KClcbiAgY29sb3IgPSAnI2RkMDAzMSc7XG4gIEBJbnB1dCgpXG4gIGRpc2FibGVkID0gZmFsc2U7XG4gIEBPdXRwdXQoKVxuICBldmVudHM6IFN1YmplY3Q8YW55PiA9IG5ldyBTdWJqZWN0KCk7XG4gIEBDb250ZW50Q2hpbGRyZW4oTmd4RmxvYXRJdGVtQnV0dG9uQ29tcG9uZW50KVxuICBidXR0b25zO1xuXG4gIHByaXZhdGUgX2Rlc3Ryb3kkID0gbmV3IFN1YmplY3QoKTtcblxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIGNkOiBDaGFuZ2VEZXRlY3RvclJlZikge1xuICAgIHRoaXMuc3RhdGUgPSBuZXcgQmVoYXZpb3JTdWJqZWN0KHtcbiAgICAgIGRpc3BsYXk6IGZhbHNlLFxuICAgICAgZGlyZWN0aW9uOiAndG9wJyxcbiAgICAgIGV2ZW50OiAnc3RhcnQnLFxuICAgICAgc3BhY2VCZXR3ZWVuQnV0dG9uczogdGhpcy5zcGFjZUJldHdlZW5CdXR0b25zXG4gICAgfSk7XG4gIH1cblxuICBwdWJsaWMgdG9nZ2xlKCkge1xuICAgIGlmICh0aGlzLmRpc2FibGVkKSB7XG4gICAgICByZXR1cm4gdGhpcy5kaXNhYmxlZDtcbiAgICB9XG4gICAgdGhpcy5zdGF0ZS5uZXh0KHtcbiAgICAgIC4uLnRoaXMuc3RhdGUuZ2V0VmFsdWUoKSxcbiAgICAgIGRpc3BsYXk6ICF0aGlzLnN0YXRlLmdldFZhbHVlKCkuZGlzcGxheSxcbiAgICAgIGV2ZW50OiAhdGhpcy5zdGF0ZS5nZXRWYWx1ZSgpLmRpc3BsYXkgPyAnb3BlbicgOiAnY2xvc2UnXG4gICAgfSk7XG4gIH1cblxuICAvLyBvbmx5IHRvcCBhbmQgYm90dG9tIHN1cHBvcnQgY29udGVudCBlbGVtZW50XG4gIHByaXZhdGUgY2hlY2tEaXJlY3Rpb25UeXBlKCkge1xuICAgIGlmICh0aGlzLmJ1dHRvbnMudG9BcnJheSgpKSB7XG4gICAgICBsZXQgZGlzcGxheSA9ICdibG9jayc7XG5cbiAgICAgIGlmICh0aGlzLmRpcmVjdGlvbiA9PT0gJ3JpZ2h0JyB8fCB0aGlzLmRpcmVjdGlvbiA9PT0gJ2xlZnQnKSB7XG4gICAgICAgIGRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICB9XG5cbiAgICAgIHRoaXMuYnV0dG9ucy50b0FycmF5KCkuZm9yRWFjaChlbGVtZW50ID0+IHtcbiAgICAgICAgZWxlbWVudC5jb250ZW50cmVmLm5hdGl2ZUVsZW1lbnQuc3R5bGUuZGlzcGxheSA9IGRpc3BsYXk7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICAvLyB0cmFuc2l0aW9uXG4gIHByaXZhdGUgYW5pbWF0ZUJ1dHRvbnMoZXZlbnRUeXBlKSB7XG4gICAgdGhpcy5idXR0b25zLnRvQXJyYXkoKS5mb3JFYWNoKChidG4sIGkpID0+IHtcbiAgICAgIGkgKz0gMTtcbiAgICAgIGNvbnN0IHN0eWxlID0gYnRuLmVsZW1lbnRyZWYubmF0aXZlRWxlbWVudC5zdHlsZTtcblxuICAgICAgaWYgKGV2ZW50VHlwZSAhPT0gJ2RpcmVjdGlvbkNoYW5nZWQnICYmIHRoaXMuc3RhdGUuZ2V0VmFsdWUoKS5kaXNwbGF5KSB7XG4gICAgICAgIHN0eWxlWyd0cmFuc2Zvcm0nXSA9ICdzY2FsZSgxKSc7XG4gICAgICAgIHN0eWxlWyd0cmFuc2l0aW9uLWR1cmF0aW9uJ10gPSAnMHMnO1xuXG4gICAgICAgIGlmIChidG4udGltZW91dCkge1xuICAgICAgICAgIGNsZWFyVGltZW91dChidG4udGltZW91dCk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIHN0eWxlWyd0cmFuc2l0aW9uLWR1cmF0aW9uJ10gPSB0aGlzLnN0YXRlLmdldFZhbHVlKCkuZGlzcGxheSA/IGAkezkwICsgMTAwICogaX1tc2AgOiAnJztcbiAgICAgICAgc3R5bGVbJ3RyYW5zZm9ybSddID0gdGhpcy5zdGF0ZS5nZXRWYWx1ZSgpLmRpc3BsYXkgPyB0aGlzLmdldFRyYW5zbGF0ZShpKSA6ICcnO1xuICAgICAgfSwgNTApO1xuXG4gICAgICBpZiAoZXZlbnRUeXBlICE9PSAnZGlyZWN0aW9uQ2hhbmdlZCcgJiYgIXRoaXMuc3RhdGUuZ2V0VmFsdWUoKS5kaXNwbGF5KSB7XG4gICAgICAgIGJ0bi50aW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgc3R5bGVbJ3RyYW5zZm9ybSddID0gJ3NjYWxlKDApJztcbiAgICAgICAgfSwgOTAgKyAxMDAgKiBpKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIC8vIGdldCB0cmFuc2l0aW9uIGRpcmVjdGlvblxuICBwcml2YXRlIGdldFRyYW5zbGF0ZShpKSB7XG4gICAgbGV0IGFuaW1hdGlvbjtcblxuICAgIHN3aXRjaCAodGhpcy5kaXJlY3Rpb24pIHtcbiAgICAgIGNhc2UgJ3JpZ2h0JzpcbiAgICAgICAgYW5pbWF0aW9uID0gYHRyYW5zbGF0ZTNkKCR7dGhpcy5zdGF0ZS5nZXRWYWx1ZSgpLnNwYWNlQmV0d2VlbkJ1dHRvbnMgKiBpfXB4LDAsMClgO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ2JvdHRvbSc6XG4gICAgICAgIGFuaW1hdGlvbiA9IGB0cmFuc2xhdGUzZCgwLCR7dGhpcy5zdGF0ZS5nZXRWYWx1ZSgpLnNwYWNlQmV0d2VlbkJ1dHRvbnMgKiBpfXB4LDApYDtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdsZWZ0JzpcbiAgICAgICAgYW5pbWF0aW9uID0gYHRyYW5zbGF0ZTNkKC0ke3RoaXMuc3RhdGUuZ2V0VmFsdWUoKS5zcGFjZUJldHdlZW5CdXR0b25zICogaX1weCwwLDApYDtcbiAgICAgICAgYnJlYWs7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICBhbmltYXRpb24gPSBgdHJhbnNsYXRlM2QoMCwtJHt0aGlzLnN0YXRlLmdldFZhbHVlKCkuc3BhY2VCZXR3ZWVuQnV0dG9ucyAqIGl9cHgsMClgO1xuICAgICAgICBicmVhaztcbiAgICB9XG5cbiAgICByZXR1cm4gYW5pbWF0aW9uO1xuICB9XG5cbiAgbmdBZnRlckNvbnRlbnRJbml0KCkge1xuICAgIGlmICh0aGlzLmRpcmVjdGlvbikge1xuICAgICAgLy8gZmlyc3QgdGltZSB0byBjaGVja1xuICAgICAgdGhpcy5jaGVja0RpcmVjdGlvblR5cGUoKTtcbiAgICB9XG5cbiAgICB0aGlzLmJ1dHRvbnMudG9BcnJheSgpLm1hcCh2ID0+IHtcbiAgICAgIHYuY2xpY2tlZC5waXBlKHRha2VVbnRpbCh0aGlzLl9kZXN0cm95JCkpLnN1YnNjcmliZSgoKSA9PiB7XG4gICAgICAgIHRoaXMuc3RhdGUubmV4dCh7XG4gICAgICAgICAgLi4udGhpcy5zdGF0ZS5nZXRWYWx1ZSgpLFxuICAgICAgICAgIGRpc3BsYXk6IGZhbHNlLFxuICAgICAgICAgIGV2ZW50OiAnY2xvc2UnXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICB0aGlzLnN0YXRlLnBpcGUodGFrZVVudGlsKHRoaXMuX2Rlc3Ryb3kkKSkuc3Vic2NyaWJlKHYgPT4ge1xuICAgICAgdGhpcy5hbmltYXRlQnV0dG9ucyh2LmV2ZW50KTtcblxuICAgICAgdGhpcy5ldmVudHMubmV4dCh7XG4gICAgICAgIGRpc3BsYXk6IHYuZGlzcGxheSxcbiAgICAgICAgZXZlbnQ6IHYuZXZlbnQsXG4gICAgICAgIGRpcmVjdGlvbjogdi5kaXJlY3Rpb25cbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgLy8gaWYgQElucHV0IHZhbHVlcyBjaGFuZ2VzLCB3ZSBuZWVkIGNoZWNrIHRoZSBkaXJlY3Rpb24gdHlwZVxuICBuZ09uQ2hhbmdlcyhjaGFuZ2VzKSB7XG4gICAgaWYgKGNoYW5nZXMuZGlyZWN0aW9uICYmICFjaGFuZ2VzLmRpcmVjdGlvbi5maXJzdENoYW5nZSkge1xuICAgICAgdGhpcy5zdGF0ZS5uZXh0KHtcbiAgICAgICAgLi4udGhpcy5zdGF0ZS5nZXRWYWx1ZSgpLFxuICAgICAgICBldmVudDogJ2RpcmVjdGlvbkNoYW5nZWQnLFxuICAgICAgICBkaXJlY3Rpb246IGNoYW5nZXMuZGlyZWN0aW9uLmN1cnJlbnRWYWx1ZVxuICAgICAgfSk7XG4gICAgICAvLyBpZiBjaGFuZ2VzIGhhcHBlbnNcbiAgICAgIHRoaXMuY2hlY2tEaXJlY3Rpb25UeXBlKCk7XG4gICAgfVxuXG4gICAgaWYgKGNoYW5nZXMub3BlbiAmJiBjaGFuZ2VzLm9wZW4uY3VycmVudFZhbHVlKSB7XG4gICAgICB0aGlzLm9wZW4ucGlwZSh0YWtlVW50aWwodGhpcy5fZGVzdHJveSQpKS5zdWJzY3JpYmUodiA9PiB7XG4gICAgICAgIGlmICh2ICE9PSB0aGlzLnN0YXRlLmdldFZhbHVlKCkuZGlzcGxheSkge1xuICAgICAgICAgIHRoaXMuc3RhdGUubmV4dCh7XG4gICAgICAgICAgICAuLi50aGlzLnN0YXRlLmdldFZhbHVlKCksXG4gICAgICAgICAgICBldmVudDogdiA/ICdvcGVuJyA6ICdjbG9zZScsXG4gICAgICAgICAgICBkaXNwbGF5OiB2XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICAvLyBtYWtlIGFuZ3VsYXIgaGFwcHlcbiAgICAgICAgICB0aGlzLmNkLm1hcmtGb3JDaGVjaygpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpZiAoY2hhbmdlcy5zcGFjZUJldHdlZW5CdXR0b25zICYmIGNoYW5nZXMuc3BhY2VCZXR3ZWVuQnV0dG9ucy5jdXJyZW50VmFsdWUpIHtcbiAgICAgIHRoaXMuc3RhdGUubmV4dCh7XG4gICAgICAgIC4uLnRoaXMuc3RhdGUuZ2V0VmFsdWUoKSxcbiAgICAgICAgZXZlbnQ6ICdzcGFjZUJldHdlZW5CdXR0b25zQ2hhbmdlZCcsXG4gICAgICAgIHNwYWNlQmV0d2VlbkJ1dHRvbnM6IGNoYW5nZXMuc3BhY2VCZXR3ZWVuQnV0dG9ucy5jdXJyZW50VmFsdWVcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIG5nT25EZXN0cm95KCkge1xuICAgIHRoaXMuX2Rlc3Ryb3kkLm5leHQoKTtcbiAgfVxufVxuIiwiaW1wb3J0IHsgTmdNb2R1bGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IENvbW1vbk1vZHVsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbic7XG5pbXBvcnQgeyBNYXRJY29uTW9kdWxlIH0gZnJvbSAnQGFuZ3VsYXIvbWF0ZXJpYWwnO1xuaW1wb3J0IHsgTmd4RmxvYXRCdXR0b25Db21wb25lbnQgfSBmcm9tICcuL25neC1mbG9hdC1idXR0b24uY29tcG9uZW50JztcbmltcG9ydCB7IE5neEZsb2F0SXRlbUJ1dHRvbkNvbXBvbmVudCB9IGZyb20gJy4vbmd4LWZsb2F0LWl0ZW0tYnV0dG9uLmNvbXBvbmVudCc7XG5cbkBOZ01vZHVsZSh7XG4gIGltcG9ydHM6IFtDb21tb25Nb2R1bGUsIE1hdEljb25Nb2R1bGVdLFxuICBkZWNsYXJhdGlvbnM6IFtOZ3hGbG9hdEJ1dHRvbkNvbXBvbmVudCwgTmd4RmxvYXRJdGVtQnV0dG9uQ29tcG9uZW50XSxcbiAgZXhwb3J0czogW05neEZsb2F0QnV0dG9uQ29tcG9uZW50LCBOZ3hGbG9hdEl0ZW1CdXR0b25Db21wb25lbnRdXG59KVxuZXhwb3J0IGNsYXNzIE5neEZsb2F0QnV0dG9uTW9kdWxlIHt9XG4iXSwibmFtZXMiOlsiSW5qZWN0YWJsZSIsIkV2ZW50RW1pdHRlciIsIkNvbXBvbmVudCIsIkNoYW5nZURldGVjdGlvblN0cmF0ZWd5IiwiSW5wdXQiLCJPdXRwdXQiLCJWaWV3Q2hpbGQiLCJTdWJqZWN0IiwiQmVoYXZpb3JTdWJqZWN0IiwidGFrZVVudGlsIiwiQ2hhbmdlRGV0ZWN0b3JSZWYiLCJDb250ZW50Q2hpbGRyZW4iLCJOZ01vZHVsZSIsIkNvbW1vbk1vZHVsZSIsIk1hdEljb25Nb2R1bGUiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFBQTtRQU9FO1NBQWlCOztvQkFMbEJBLGFBQVUsU0FBQzt3QkFDVixVQUFVLEVBQUUsTUFBTTtxQkFDbkI7Ozs7O29DQUpEO0tBRUE7O0lDRkE7Ozs7Ozs7Ozs7Ozs7O0FBY0EsSUFlTyxJQUFJLFFBQVEsR0FBRztRQUNsQixRQUFRLEdBQUcsTUFBTSxDQUFDLE1BQU0sSUFBSSxTQUFTLFFBQVEsQ0FBQyxDQUFDO1lBQzNDLEtBQUssSUFBSSxDQUFDLEVBQUUs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